// Generated by CoffeeScript 1.12.6
(function() {
  var currentPage, generateRow, loadItems;

  currentPage = 0;

  loadItems = function(page, container, btnPre, btnSuc, pageIndicator) {
    return listItems({
      page: page
    }, function(result) {
      var i, item, len, ref, results;
      if (result['code'] === 704) {
        currentPage = result['object']['currentPage'];
        if (result['object']['isFirst']) {
          btnPre.addClass('disabled');
        } else {
          btnPre.removeClass('disabled');
        }
        if (result['object']['isLast']) {
          btnSuc.addClass('disabled');
        } else {
          btnSuc.removeClass('disabled');
        }
        pageIndicator.text(result['object']['currentPage']);
        container.empty();
        ref = result['object']['bookMarkItems'];
        results = [];
        for (i = 0, len = ref.length; i < len; i++) {
          item = ref[i];
          results.push(container.append(generateRow(item)));
        }
        return results;
      } else {
        if (result['code'] === 802) {
          return console.log("802");
        }
      }
    });
  };

  $(function() {
    var btnPre, btnSuc, container, pageIndicator;
    container = $('#tableBody');
    btnPre = $('.btnPre');
    btnSuc = $('.btnSuc');
    pageIndicator = $('.pageIndicator');
    btnPre.click(function() {
      return loadItems(currentPage - 2, container, btnPre, btnSuc, pageIndicator);
    });
    btnSuc.click(function() {
      return loadItems(currentPage, container, btnPre, btnSuc, pageIndicator);
    });
    return loadItems(0, container, btnPre, btnSuc, pageIndicator);
  });

  generateRow = function(item) {
    var tagsBadges;
    tagsBadges = item['tag'].map(function(e) {
      return "<span class=\"badge badge-default\">" + (unescape(e['name'])) + "</span>";
    }).join(' ');
    return "<tr><td>" + item['id'] + "</td><td> <a href=\'" + item['url'] + "\'>" + (unescape(item['name'])) + "</a> </td><td>" + tagsBadges + " </td><td>n/a</td><td></td></tr>";
  };

}).call(this);
